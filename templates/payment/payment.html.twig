{% extends 'base.html.twig' %}

{% block title %}Paiement - EcoRide{% endblock %}

{% block body %}

<!-- ============================================================
     HERO
=============================================================== -->
<section class="hero-global hero-paiement d-flex align-items-center text-center text-white position-relative">
  <div class="container">
    <h2 class="hero-title mb-3">Paiement</h2>
    <p class="hero-tagline mb-4">Finalise ta r√©servation en toute simplicit√©</p>
  </div>
</section>

<!-- ============================================================
     SECTION PAIEMENT TOKENS
=============================================================== -->
<section class="py-5 bg-ecoride-light">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-8 col-lg-6">

        <div class="ecoride-form bg-white shadow p-4 rounded-4">

          <!-- TITRE -->
          <div class="text-center mb-4">
            <h2 class="fw-bold text-eco-primary">Paiement par Tokens</h2>
            <p class="text-muted">
              Merci {{ app.user.prenom ?? app.user.email }},<br>
              v√©rifie les informations avant de confirmer.
            </p>
          </div>

          <!-- INFOS TRAJET -->
          <div class="mb-4 p-3 rounded-3 bg-light border">
            <p class="mb-1">
              <strong>D√©part :</strong> {{ trajet.villeDepart }} ‚Äî {{ trajet.pointDepart }}
            </p>
            <p class="mb-1">
              <strong>Arriv√©e :</strong> {{ trajet.villeArrivee }} ‚Äî {{ trajet.pointArrivee }}
            </p>
            <p class="mb-1">
              <strong>Date :</strong> {{ trajet.dateDepart|date('d/m/Y H:i') }}
            </p>
            <p class="mb-0">
              <strong>Co√ªt :</strong>
              <span class="text-eco-primary">{{ trajet.tokenCost }} tokens</span>
            </p>
          </div>

          <!-- SOLDE UTILISATEUR -->
          <div class="alert alert-info text-center fw-semibold">
            Solde actuel : <span class="text-success">{{ app.user.tokens }}</span> tokens
          </div>

          <!-- FORMULAIRE -->
          <form method="post"
                action="{{ path('payment_process', { id: trajet.id }) }}"
                class="eco-form">

            {% if app.user.tokens >= trajet.tokenCost %}
              <button type="submit"
                      class="btn btn-ecoride w-100 py-2 fw-semibold rounded-pill mt-2">
                Payer avec mes Tokens üåø
              </button>
            {% else %}
              <div class="alert alert-danger text-center mt-3">
                Solde insuffisant pour ce trajet.
              </div>
            {% endif %}
          </form>

          <!-- RETOUR -->
          <div class="text-center mt-4">
            <a href="{{ path('app_home') }}"
               class="small text-success text-decoration-none">
              ‚Üê Retour √† l'accueil
            </a>
          </div>

        </div>

      </div>
    </div>
  </div>
</section>

{% endblock %}
